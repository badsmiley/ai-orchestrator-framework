# Agent Levels — Уровни агентов

## Иерархия

```
┌─────────────────────────────────────┐
│           HUMAN / OWNER             │
│         (Внешний мир, цели)         │
└──────────────┬──────────────────────┘
               │
               ▼
┌─────────────────────────────────────┐
│      LEVEL 0: ORCHESTRATOR          │
│  ┌─────────────────────────────┐    │
│  │ Главный AI-агент            │    │
│  │ • Принимает цели            │    │
│  │ • Декомпозирует задачи      │    │
│  │ • Управляет департаментами  │    │
│  │ • Держит глобальную картину │    │
│  └─────────────────────────────┘    │
└──────────────┬──────────────────────┘
               │
     ┌─────────┼─────────┐
     ▼         ▼         ▼
┌────────┐ ┌────────┐ ┌────────┐
│ L1:    │ │ L1:    │ │ L1:    │
│ DEP A  │ │ DEP B  │ │ DEP C  │
└────────┘ └────────┘ └────────┘
     │         │         │
     ▼         ▼         ▼
┌────────┐ ┌────────┐ ┌────────┐
│ L2:    │ │ L2:    │ │ L2:    │
│ WORKER │ │ WORKER │ │ WORKER │
│        │ │        │ │        │
└────────┘ └────────┘ └────────┘
```

## Level 0: Orchestrator

| Атрибут | Описание |
|---------|----------|
| **Контекст** | Глобальный — все проекты |
| **Канал** | Main chat (человек) |
| **Сессия** | Одна, основная |
| **Память** | MEMORY.md + daily notes |

## Level 1: Department (Sub-agent)

| Атрибут | Описание |
|---------|----------|
| **Контекст** | Проектный — один проект/домен |
| **Канал** | Внутренняя сессия |
| **Сессия** | Отдельная через `sessions_spawn` |
| **Память** | project-specific files |

## Level 2: Worker (Опционально)

| Атрибут | Описание |
|---------|----------|
| **Контекст** | Задачный — одна конкретная задача |
| **Канал** | Внутренняя сессия или tmux |
| **Сессия** | Ephemeral (временная) |
| **Память** | inline, minimal |

---

## Когда использовать какой уровень

| Ситуация | Уровень |
|----------|---------|
| Человек даёт новую цель | L0 → декомпозиция → L1 |
| Задача в рамках проекта | L1 (department) |
| Большая задача, декомпозиция | L1 → L2 (workers) |
| Быстрая одноразовая задача | L1 или L2 напрямую |

---

## Пример жизни агента

1. **Человек:** "Хочу настроить Stripe для ХХХ"
2. **L0 (Orchestrator):**
   - Декомпозирует → "нужен env vars + webhook"
   - Спавнит `ХХХ Dev` (L1)
3. **L1 (ХХХ Dev):**
   - Получает задачу
   - Проверяет что есть, что нужно
   - Репортит L0: "✓ env vars добавлены, жду webhook secret"
4. **L0:**
   - Получает отчёт
   - Может: (a) передать человеку, (b) спавнить ещё агента, (c) ждать

---

## Коммуникационные правила

| От → Кому | Когда | Формат |
|-----------|-------|--------|
| L0 → L1 | Задача | Декомпозированная подзадача |
| L1 → L0 | Отчёт | Micro-report |
| L1 → L2 | Подзадача | Краткая инструкция |
| L2 → L1 | Результат | Что сделано + статус |

**Важно:** L2 → L0 напрямую — только если L1 недоступен.
